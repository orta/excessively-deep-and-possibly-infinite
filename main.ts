namespace SpriteKind {
    export const progressBar = SpriteKind.create()
    export const TaggingSpot = SpriteKind.create()
}
namespace myTiles {
    //% blockIdentity=images._tile
    export const tile0 = img`
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
`
    //% blockIdentity=images._tile
    export const tile1 = img`
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
b b b b b b b b b b b b b b b 8 
8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 
`
    //% blockIdentity=images._tile
    export const tile3 = img`
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
`
    //% blockIdentity=images._tile
    export const tile4 = img`
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
f f f f f f f f f f f f f f f f 
e e 9 9 e 9 9 e e e e e e e e e 
a e 9 9 e 9 9 e 9 9 9 9 9 9 9 9 
a a e e a e e a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
a a a a a a a a a a a a a a a 8 
b b b b b b b b b b b b b b b 8 
8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 
`
    //% blockIdentity=images._tile
    export const tile5 = img`
f f f f f f f f f f f f f f f f 
f f f f f f f f f f f f f f f f 
f f f f f f f f f f f f f f f f 
f f f f f f f f f f f f f f f f 
b b b b b b b b b b b b b b b b 
c c c c c c c c c c c c c c c c 
f f f e c c f f f e c c f f f e 
f e f f c c f e f f c c f e f f 
e f f f c c e f f f c c e f f f 
f f f f c c f f f f c c f f f f 
a b b b c c b b b b c c b b b b 
c c c c c c c c c c c c c c c c 
c c c c c c c c c c c c c c c c 
c c c c c c c c c c c c c c c c 
c c c c c c c c c c c c c c c c 
c c c c c c c c c c c c c c c c 
`
    //% blockIdentity=images._tile
    export const tile6 = img`
f f f f f f f f f f f f f f f f 
f f f f f f f f f f f f f f f f 
f f f f f f f f f f f f f f f f 
f f f f f f f f f f f f f f f f 
b b b b b b b b b b b b b b b b 
c c c c c c c c c c c c c c c c 
f f c c c b b b b b b c c c f e 
f e c c b f f b b f f b c c f f 
e f c c b f e b b f e b c c f f 
f f c c b f f b b f f b c c f f 
a b c c b c b b b b c b b c b b 
c c c c b f f b b f f b b c c c 
c c c c b e f b b e f b b c c c 
c c c c b f f b b f f b c c c c 
c c c c b f f b b f f b c c c c 
c c c c b f f b b f f b c c c c 
`
    //% blockIdentity=images._tile
    export const tile7 = img`
f f f f f f f f f f f f f f f f 
f f f f f f f f f f f f f f f f 
f f f f f f f f f f f f f f f f 
f f f f f f f f f f f f f f f f 
b b b b b b b b b b b b b b b b 
a b c c c c c c c c c c c c c c 
a b f e c c f f f e c c f f f e 
a b d f c c f e f f c c f e f f 
a b d f c c e f f f c c e f f f 
a b d d c c f f f f c c f f f f 
a b d d c c b b b b c c b b b b 
a b f b c c c c c c c c c c c c 
a b f b c c c c c c c c c c c c 
a b b c c c c c c c c c c c c c 
a b c c c c c c c c c c c c c c 
a b c c c c c c c c c c c c c c 
`
    //% blockIdentity=images._tile
    export const tile8 = img`
f f f f f f f f f f f f f f f a 
f f f f f f f f f f f f f f f a 
f f f f f f f f f f f f f f f a 
f f f f f f f f f f f f f f f a 
b b b b b b b b b b b b b b b a 
c c c c c c c c c c c c c c a a 
f f f f c c f f f e c c f f a a 
f f f f c c f e f f c c f e a a 
f f f f c c e f f f c c e f a a 
f f f f c c f f f f c c f f a a 
b b b b c c b b b b c c b b a a 
c c c c c c c c c c c c c c a a 
c c c c c c c c c c c c c c a a 
c c c c c c c c c c c c c c a a 
c c c c c c c c c c c c c c c a 
c c c c c c c c c c c c c c c a 
`
    //% blockIdentity=images._tile
    export const tile9 = img`
f f f f f f a a a f f f f f f f 
f f f f f f a a a f f f f f f f 
f f f f f f a a a f f f f f f f 
f f f f f f a a a f f f f f f f 
b b b b b b a a a b b b b b b b 
c c c c c c a a a c c c c c c c 
f f f e c c a a a c c c f f f e 
f e f f c c e a e c c c f e f f 
e f f f c c a e a c c c e f f f 
f f f f c c a a a c c c f f f f 
a b b b c c a a a c c c b b b b 
c c c c c c e e e c c c c c c c 
c c c c c c e e e c c c c c c c 
c c c c c c e e e c c c c c c c 
c c c c c c a a a c c c c c c c 
c c c c c c a a a c c c c c c c 
`
    //% blockIdentity=images._tile
    export const tile10 = img`
d d d d d a a a a a d d d d d d 
d d d d d d a a a d d d d d d d 
d d d d d d a a a d d d d d d d 
d d d d d d a a a d d d d d d d 
d d d d d d a a a d d d d d d d 
d d d d d d a a a d d d d d d d 
d d d d d d a a a d d d d d d d 
d d d d d d a a a d d d d d d d 
d d d d d d a a a d d d d d d d 
d d d d d d f a f d d d d d d d 
d d d d d d a f a d d d d d d d 
d d d d d d a a a d d d d d d d 
d d d d d d a a a d d d d d d d 
d d d d d d a a a d d d d d d d 
d d d d d d a a a d d d d d d d 
d d d d d d a a a d d d d d d d 
`
    //% blockIdentity=images._tile
    export const tile11 = img`
a d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
d d d d d d d d d d d d d d d d 
`
    //% blockIdentity=images._tile
    export const tile12 = img`
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 
7 8 8 8 8 8 7 8 8 8 8 7 8 8 8 7 
7 8 8 8 8 8 7 8 8 8 8 7 8 8 8 7 
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 
7 8 8 8 7 8 8 8 7 8 8 8 8 8 8 7 
7 8 8 8 7 8 8 8 7 8 8 8 8 8 8 7 
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 
7 8 8 8 8 8 8 8 7 8 8 8 7 8 8 7 
7 8 8 8 8 8 8 8 7 8 8 8 7 8 8 7 
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 
7 8 8 8 7 8 8 8 8 8 8 7 8 8 8 7 
7 8 8 8 7 8 8 8 8 8 8 7 8 8 8 7 
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 
7 8 8 8 8 7 8 8 8 7 8 8 8 8 8 7 
7 8 8 8 8 7 8 8 8 7 8 8 8 8 8 7 
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 
`
}
controller.left.onEvent(ControllerButtonEvent.Pressed, function () {
    tagger.setImage(img`
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . f f 9 9 . . . . . . . 
. . . . . f 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
`)
})
controller.down.onEvent(ControllerButtonEvent.Pressed, function () {
    tagger.setImage(img`
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . f f f f . . . . . . . 
. . . . . 9 f f 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 3 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
`)
})

function advanceProgressBar(frame: number) {
    progressBar2.setImage(progressBarFrames[frame])
    if (controller.A.isPressed()) {
        if (frame < progressBarFrames.length) {
            taggingTimeout = setTimeout(function () {
                advanceProgressBar(frame + 1);
            }, 250);
        } else {
            completeTagging()
        }
    }
}
function startTagging() {
    isTagging = true
    progressBar2.setFlag(SpriteFlag.Invisible, false)
    progressBar2.x = tagger.x
    progressBar2.y = tagger.y - 10
    advanceProgressBar(0)
}
function cancelTagging() {
    isTagging = false
    clearTimeout(taggingTimeout);
    progressBar2.setFlag(SpriteFlag.Invisible, true)
}
function completeTagging() {
    cancelTagging()
    music.baDing.play()
    info.changeScoreBy(1)
}
function moveTaggingSpot() {
    tiles.placeOnRandomTile(tagTarget, myTiles.tile4)
}
controller.A.onEvent(ControllerButtonEvent.Pressed, function () {
    startTagging()
    distX = Math.abs(tagger.x) - Math.abs(tagTarget.x)
    distY = Math.abs(tagger.y) - Math.abs(tagTarget.y)
    console.log(`x ${distX} y, ${distY}`)
    if (distX < 20 && distY < 20) {
        tagger.setImage(img`
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . 9 . 9 9 9 9 . 9 . . . . . 
. . . . 9 . . . . 9 . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
`)
    }
})
controller.right.onEvent(ControllerButtonEvent.Pressed, function () {
    tagger.setImage(img`
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 f f . . . . . . . 
. . . . . 9 9 9 f . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 3 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
`)
})
sprites.onOverlap(SpriteKind.Player, SpriteKind.TaggingSpot, function (sprite, otherSprite) {
    otherSprite.setImage(img`
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 
. 3 3 3 3 3 3 3 3 3 3 3 3 3 3 . 
. 3 3 3 3 3 3 3 3 3 3 3 3 3 3 . 
`)
})
controller.up.onEvent(ControllerButtonEvent.Pressed, function () {
    tagger.setImage(img`
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . 9 9 9 9 . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
`)
})
controller.A.onEvent(ControllerButtonEvent.Released, function () {
    cancelTagging()
})
let isTagging = false
let tagger: Sprite = null
let progressBar2: Sprite = null
let progressBarFrames: Image[] = []
let progressTimer = null
let taggingTimeout = 0
let isMoving = false
let tagTarget: Sprite = null
let distX = 0
let distY = 0

progressBarFrames = [img`
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    9 3 3 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
    9 3 3 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
    9 3 3 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
`, img`
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    9 3 3 3 3 3 3 . . . . . . . . . . . . . . . . . . . . . . . . 9
    9 3 3 3 3 3 3 . . . . . . . . . . . . . . . . . . . . . . . . 9
    9 3 3 3 3 3 3 . . . . . . . . . . . . . . . . . . . . . . . . 9
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
`, img`
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    9 3 3 3 3 3 3 3 3 3 . . . . . . . . . . . . . . . . . . . . . 9
    9 3 3 3 3 3 3 3 3 3 . . . . . . . . . . . . . . . . . . . . . 9
    9 3 3 3 3 3 3 3 3 3 . . . . . . . . . . . . . . . . . . . . . 9
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
`, img`
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 . . . . . . . . . . . . . . . . . . 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 . . . . . . . . . . . . . . . . . . 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 . . . . . . . . . . . . . . . . . . 9
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
`, img`
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 . . . . . . . . . . . . . . . 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 . . . . . . . . . . . . . . . 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 . . . . . . . . . . . . . . . 9
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
`, img`
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 . . . . . . . . . . . . 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 . . . . . . . . . . . . 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 . . . . . . . . . . . . 9
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
`, img`
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 . . . . . . . . . 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 . . . . . . . . . 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 . . . . . . . . . 9
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
`, img`
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 . . . . . . 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 . . . . . . 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 . . . . . . 9
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
`, img`
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 . . . 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 . . . 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 . . . 9
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
`, img`
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 9
    9 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 9
    9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
`]
progressBar2 = sprites.create(img`
    .
`, 0)


tiles.setTilemap(tiles.createTilemap(
            hex`1c001400020202020202020202020202020202021b0808080e03030303030303021911111111111811111111020202021b0808080e03030303030303021513141313131713141316020202021b0808080e03030303030303021212121212121212121212020202021b0808080e03030303030303020202020202020202020202020202021b0808080e03030303030303021911111111110202021911111111111b0808080e03030303030303021514131413160202021514131313161b0808080e03030303030303021212121212120202021212121212121b0808080e03030303030303020202020202020202020202020202021b0808080e03030303030303111111111118111111111111020202021b0808080e03030303030303131314131317141313131316020202021b0808080e03030303030303121212121212121212121212020202021b0808080e03030303030303020202020202020202020202020202021b0808080e03030303030303021911111111111102191111111111021b0808080e03030303030303021514131314131602131413131416021b0808080e03030303030303021212121212121202121212121212021b0808080e03030303030303020202020202020202020202020202021b0808080e03030303030303020202021911111111111111020202021b0808080e03030303030303020202021513141313141316020202021b0808080e03030303030303020202021212121212121212020202021b0808080e03030303030303`,
            img`
. . . . . . . . . . . . . . . . 2 . . . . . . . . . . . 
. 2 2 2 2 2 2 2 2 2 2 2 . . . . 2 . . . . . . . . . . . 
. 2 2 2 2 2 2 2 2 2 2 2 . . . . 2 . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 2 . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 2 . . . . . . . . . . . 
. 2 2 2 2 2 2 . . . 2 2 2 2 2 2 2 . . . . . . . . . . . 
. 2 2 2 2 2 2 . . . 2 2 2 2 2 2 2 . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 2 . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 2 . . . . . . . . . . . 
2 2 2 2 2 2 2 2 2 2 2 2 . . . . 2 . . . . . . . . . . . 
2 2 2 2 2 2 2 2 2 2 2 2 . . . . 2 . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 2 . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 2 . . . . . . . . . . . 
. 2 2 2 2 2 2 2 . 2 2 2 2 2 2 . 2 . . . . . . . . . . . 
. 2 2 2 2 2 2 2 . 2 2 2 2 2 2 . 2 . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 2 . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 2 . . . . . . . . . . . 
. . . . 2 2 2 2 2 2 2 2 . . . . 2 . . . . . . . . . . . 
. . . . 2 2 2 2 2 2 2 2 . . . . 2 . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 2 . . . . . . . . . . . 
`,
            [myTiles.tile0,sprites.builtin.forestTiles23,myTiles.tile1,sprites.castle.tilePath5,sprites.builtin.brick,sprites.vehicle.roadVertical,sprites.vehicle.roadHorizontal,sprites.dungeon.doorOpenNorth,sprites.castle.tileGrass1,sprites.castle.tilePath1,sprites.castle.tileGrass2,sprites.castle.tileGrass3,sprites.castle.tilePath2,sprites.castle.tilePath7,sprites.castle.tilePath4,sprites.castle.tilePath8,sprites.builtin.forestTiles24,myTiles.tile3,myTiles.tile4,myTiles.tile5,myTiles.tile6,myTiles.tile7,myTiles.tile8,myTiles.tile9,myTiles.tile10,myTiles.tile11,sprites.builtin.coral2,myTiles.tile12],
            TileScale.Sixteen
        ))
tagTarget = sprites.create(img`
. . . . . . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . . . . . 
. . . . . . 1 1 1 1 1 1 1 1 . . . . . . 
. . . 1 1 1 . . . . . . . . 1 1 1 . . . 
. 1 1 . . . . . . . . . . . . . . 1 1 . 
1 . . . . . . . . 1 1 . . . . . . . . 1 
1 . . . . . . . . 1 1 . . . . . . . . 1 
. 1 1 . . . . . . . . . . . . . . 1 1 . 
. . . 1 1 1 . . . . . . . . 1 1 1 . . . 
. . . . . . 1 1 1 1 1 1 1 1 . . . . . . 
. . . . . . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . . . . . 
`, SpriteKind.TaggingSpot)
tagger = sprites.create(img`
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . 9 9 9 9 9 9 . . . . . 
. . . . . 9 9 9 9 9 9 . . . . . 
. . . . . 9 9 9 9 9 9 . . . . . 
. . . . . . 9 9 9 9 . . . . . . 
. . . . . . . 9 9 . . . . . . . 
. . . . . . 9 9 9 9 . . . . . . 
. . . . . 9 9 9 9 9 9 . . . . . 
. . . . . 9 9 9 9 9 9 . . . . . 
. . . . . 9 9 9 9 9 9 . . . . . 
. . . . . 9 9 9 9 9 9 . . . . . 
. . . . . 9 9 9 9 9 9 . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
. . . . . . . . . . . . . . . . 
`, SpriteKind.Player)
scene.cameraFollowSprite(tagger)
controller.moveSprite(tagger)
game.onUpdate(function () {
    if (controller.dx() != 0 || controller.dy() != 0) {
        cancelTagging()
    }
})
